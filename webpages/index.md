---
title: "JDrupes Builder"
description: >-
  A build automation tool for that uses Java code for its configuration 
  and centers around resources.
layout: jdbld
---

# Welcome to JDrupes Builder

JDrupes Builder (jdbld) is a
[build automation tool](https://en.wikipedia.org/wiki/Build_system_(software_development))
that uses Java code for its configuration and models builds as collections
of resources that are produced on demand.

Here's the source code for a sample build configuration, which will be explained
in more detail below:

```java
public class SimpleApp extends AbstractProject implements RootProject {

    public SimpleApp() {
        super(name("simple-app"));
        generator(JavaCompiler::new).addSources(Path.of("src"), "**/*.java");
        generator(UberJarGenerator::new).from(providers(Supply))
            .mainClass("jdbld.demo.simpleapp.App");

        // Command arguments
        commandAlias("build", requestFor(AppJarFile.class));
    }
}
```

In jdbld terminology, a build system is a provider of resources.
It is implemented as a graph of
[ResourceProvider](javadoc/org/jdrupes/builder/api/ResourceProvider.html)s,
which provide [Resource](javadoc/org/jdrupes/builder/api/Resource.html)s in
response to
[ResourceRequest](javadoc/org/jdrupes/builder/api/ResourceRequest.html)s. The
topmost layer of the build system's configuration is a collection of
classes that implement the special resource provider
[Project](javadoc/org/jdrupes/builder/api/Project.html). Projects provide
resources by requesting them from other
[ResourceProvider](javadoc/org/jdrupes/builder/api/ResourceProvider.html)s. 

![Builder classes](javadoc/project-provider-classes.svg)

## Single project builds

In a single project build configuration, an instance of the defined
project class provides all resources by requesting them from its 
[Generator](javadoc/org/jdrupes/builder/api/Generator.html)s, which are
another special kind of
[ResourceProvider](javadoc/org/jdrupes/builder/api/ResourceProvider.html)s.

![Single project classes](javadoc/single-project-classes.svg)

A build configuration (a.k.a. project) for a simple Java application
is shown below. It illustrates the objects generated by the
source code of the aforementioned sample build configuration.

![Simple app jar project](javadoc/simple-appjar-project.svg)

The project uses two generators. The first is a
[JavaCompiler](javadoc/org/jdrupes/builder/java/JavaCompiler.html), which
provides resources of type
[ClassTree](javadoc/org/jdrupes/builder/java/ClassTree.html) to the project.

```java
        generator(JavaCompiler::new).addSources(Path.of("src"), "**/*.java");
```

The second generator is an
[UberJarGenerator](javadoc/org/jdrupes/builder/uberjar/UberJarGenerator.html).

```java
        generator(UberJarGenerator::new).from(providers(Supply))
            .mainClass("jdbld.demo.simpleapp.App");
```

This generator can provide resources of type
[AppJarFile](javadoc/org/jdrupes/builder/java/AppJarFile.html). Instantiated
as shown above, it uses the
[ClasspathElement](javadoc/org/jdrupes/builder/java/ClasspathElement.html)s
generated by the project as input for the jar's contents.

You might wonder why the app jar generator goes back to the project
to retrieve the classpath elements. Looking at the API, we could also 
configure the app jar generator to use the classpath elements from the
Java compiler directly. There are two reasons for this. First, a user 
might want to request the class tree from the project which would not
be possible if the resources provided by the Java compiler were used
as input to the app jar generator only. The second reason will become
apparent when we discuss a multi-project build configuration, in which
a project can provide resources from another project in addition to
those obtained from its generators.

For further clarification, the diagram below shows the sequence of operations
as they happen when a user requests the application jar from the project.  

![Simple app jar project](javadoc/build-appjar-project.svg)

